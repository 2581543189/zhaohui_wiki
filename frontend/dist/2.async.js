(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"221B":function(e,a,t){"use strict";var r=t("TqRt");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=r(t("o0o1")),s=r(t("MVZn")),o=t("7Y5E"),i=t("+n12"),l={namespace:"data_book",state:{list:[],pagination:{current:1,pageSize:10,total:0},formValues:{name:"",first:"",second:"",third:""},options:[],modalVisible:!1,updateModalData:{id:0,name:"-",author:"-",url:"http://",first:"",second:"",third:"",count:0,current:0,startDate:"1970-01-01",endDate:null,img:"",score:""},updateModalVisible:!1},effects:{fetch:n.default.mark(function e(a,t){var r,l,d,u,c,p,f;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,l=t.call,d=t.put,u=t.select,"undefined"==typeof r&&(r={}),e.next=5,u(e=>e.data_book.formValues);case 5:return c=e.sent,p=(0,s.default)({},c,r),e.next=9,l(o.queryBook,p);case 9:if(f=e.sent,1==f.error){e.next=17;break}return e.next=13,d({type:"save",payload:f});case 13:return e.next=15,d({type:"setFormValues",payload:{formValues:{title:p.title,first:p.first,second:p.second,third:p.third}}});case 15:e.next=18;break;case 17:(0,i.openNotification)("error",f.message);case 18:case"end":return e.stop()}},e,this)}),getOption:n.default.mark(function e(a,t){var r,s,l,d;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,s=t.call,l=t.put,e.next=4,s(o.distinctValue,r);case 4:if(d=e.sent,1==d.error){e.next=10;break}return e.next=8,l({type:"addOptions",payload:d});case 8:e.next=11;break;case 10:(0,i.openNotification)("error",d.message);case 11:case"end":return e.stop()}},e,this)}),add:n.default.mark(function e(a,t){var r,s,l,d,u;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,a.callback,s=t.call,l=t.put,d=t.select,e.next=4,s(o.addBook,r);case 4:if(u=e.sent,1==u.error){e.next=16;break}return e.next=8,l({type:"setModalVisible",payload:!1});case 8:return(0,i.openNotification)("success","\u65b0\u589e\u4e66\u7c4d"+u.name+"["+u.id+"]\u6210\u529f"),e.next=11,d(e=>e.data_book.formValues);case 11:return e.sent,e.next=14,l({type:"fetch",payload:{currentPage:1,pageSize:10,id:u.id}});case 14:e.next=17;break;case 16:(0,i.openNotification)("error",u.message);case 17:case"end":return e.stop()}},e,this)}),delete:n.default.mark(function e(a,t){var r,l,d,u,c,p;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,l=t.call,d=t.put,u=t.select,e.next=4,l(o.deleteBook,r);case 4:if(c=e.sent,1==c.error){e.next=14;break}return(0,i.openNotification)("success","\u5220\u9664\u4e66\u7c4d["+c.id+"]\u6210\u529f"),e.next=9,u(e=>e.data_book.formValues);case 9:return p=e.sent,e.next=12,d({type:"fetch",payload:(0,s.default)({currentPage:1,pageSize:10},p)});case 12:e.next=15;break;case 14:(0,i.openNotification)("error",c.message);case 15:case"end":return e.stop()}},e,this)}),updateStep1:n.default.mark(function e(a,t){var r,s,l,d,u;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,s=t.call,l=t.put,d={id:r.id},e.next=5,s(o.queryBook,d);case 5:if(u=e.sent,1==u.error){e.next=11;break}return e.next=9,l({type:"setUpdateModalVisible",payload:{updateModalVisible:!0,updateModalData:u.list[0]}});case 9:e.next=12;break;case 11:(0,i.openNotification)("error",u.message);case 12:case"end":return e.stop()}},e,this)}),updateStep2:n.default.mark(function e(a,t){var r,l,d,u,c,p;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.payload,l=t.call,d=t.put,u=t.select,e.next=4,l(o.updateBook,r);case 4:if(c=e.sent,1==c.error){e.next=15;break}return e.next=8,d({type:"setUpdateModalVisible",payload:{updateModalVisible:!1,updateModalData:{id:0,name:"-",author:"-",url:"http://",first:"",second:"",third:"",count:0,current:0,startDate:"1970-01-01",endDate:null,img:"",score:""}}});case 8:return e.next=10,u(e=>e.data_book.formValues);case 10:return p=e.sent,e.next=13,d({type:"fetch",payload:(0,s.default)({currentPage:1,pageSize:10},p)});case 13:e.next=16;break;case 15:(0,i.openNotification)("error",c.message);case 16:case"end":return e.stop()}},e,this)})},reducers:{save(e,a){return(0,s.default)({},e,{list:a.payload.list,pagination:a.payload.pagination})},setFormValues(e,a){return e.formValues=(0,s.default)({},e.formValues,a.payload.formValues),(0,s.default)({},e)},setModalVisible(e,a){return(0,s.default)({},e,{modalVisible:a.payload})},setUpdateModalVisible(e,a){var t={id:0,name:"-",author:"-",url:"http://",first:"",second:"",third:"",count:0,current:0,startDate:"1970-01-01",endDate:null,img:"",score:""};return(0,s.default)({},e,{updateModalVisible:a.payload.updateModalVisible,updateModalData:a.payload.updateModalData?a.payload.updateModalData:t})},addOptions(e,a){var t=a.payload.body;if("undefined"==typeof t.first||null===t.first){var r=[];t.array.map(e=>{r.unshift({value:e,label:e,isLeaf:!1})}),e.options=r}else{var n=[],o=t.first;if("undefined"==typeof t.second||null===t.second)t.array.map(e=>{n.unshift({label:e,value:e,isLeaf:!1})}),e.options.map(e=>{e.value===o&&(e.children=n)});else{var i=t.second;t.array.map(e=>{n.unshift({label:e,value:e})}),e.options.map(e=>{e.value===o&&e.children.map(e=>{e.value===i&&(e.children=n)})})}}return(0,s.default)({},e)}}};a.default=l}}]);